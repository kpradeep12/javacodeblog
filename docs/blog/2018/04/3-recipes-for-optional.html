<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">
    <meta name="google-site-verification" content="zkTSlJd8qxF4ZHbWWxyG0Prqnevef8dGSLkZeHFRW2Y" />
    
    <title>Recipes for Optional</title>

    <!-- Bootstrap Core CSS -->
    <link href="../../../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../../../css/clean-blog.css" rel="stylesheet">
    <link href="../../../css/3-portfolio-theme.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <!-- link rel="shortcut icon" href="../../../favicon.ico" -->
  </head>
  <body>
   

        <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand" href="../../../index.html">Tech Stack Java</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="../../../index.html">Home</a>
            </li>
            <!--<li class="nav-item">
                <a class="nav-link" href="../../../about.html">About</a>
            </li>-->
            <li class="nav-item">
                <a class="nav-link" href="/archive.html">Archive</a>
            </li>
            <!--<li class="nav-item">
                <a class="nav-link" href="../../../contact.html">Contact</a>
            </li>-->
          </ul>
        </div>
      </div>
    </nav>
    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('../../../img/home-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col">
                    <div class="site-heading">
                        <h1>Tech Stack Java</h1>
                        <hr class="small">
                        <span class="subheading">Sharing my Java experiments</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="mt-4">Recipes for Optional</h1>
                    <p class="mt-0 small">Posted on April 03, 2018</p>
                    <hr>
                    <!-- Preview Image -->
                    <img class="img-fluid rounded post-image" src="../../../img/banners/blog-banner-recipes-for-optional.png" alt="">


                    <div class="paragraph"> 
 <p>Optional allows us to wrap a nullable object in it so we can make a method to return Optional instead of bare object. There is a possibility that below method can return null; so we need to explicitly do the null check on the returned object before using it.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">Employee getEmployee(Integer id){
 //return employee;
}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p>Check below modified method which returns Optional&lt;Employee&gt; and it communicates very well, saying that the result can be null.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">Optional&lt;Employee&gt; getEmployee(Integer id){
 // return optional employee
}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p>I will go through some recipes to handle Optional results, before that lets create an EmployeeService which returns Employee object.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">class Employee{
    private Integer id;
    private String name;
    private Integer age;

    Employee(Integer id, String name, Integer age) {
        this.id = id;
        this.name = name;
        this.age = age;
    }

    public Integer getId() { return id; }
    public String getName() { return name; }
    public Integer getAge() { return age; }

    @Override
    public String toString() {
        return "Employee{ id=" + id +
                ", name='" + name + '\'' +
                ", age=" + age + '}';
    }
}

public class EmployeeService {
    Map&lt;Integer, Employee&gt; store = Map.of(1, new Employee(1, "Peter", 34),
            2, new Employee(2, "John", 28),
            3, new Employee(3, "Bill", 42));

    Optional&lt;Employee&gt; getEmployee(Integer id){
        return Optional.ofNullable(store.get(id));
    }
}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 1:</strong> Check if result is present in the Optional using isPresent() and if it present then get the result using get() function.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
Optional&lt;Employee&gt; emp = es.getEmployee(2);
if(emp.isPresent()){
    System.out.println(emp.get());
}
//Output: Employee{id=2, name='John', age=28}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p>Its not a good practice to use isPresent and get methods because this code is doing regular null check and then performing action on it. Instead follow the next recipes which will show you different ways to use Optional result. I used these methods to show available functions in the Optional class.</p> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 2:</strong> Consume the result with out checking null. ifPresent() takes a consumer and it is executed only if the result is not null. We no need to explicitly check the null.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
es.getEmployee(2)
    .ifPresent(System.out::println);
//Output: Employee{id=2, name='John', age=28}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 3:</strong> Consume and perform action if the result is present and if not present then perform empty action. ifPresentOrElse function takes two parameters, first parameter is consumer which will be executed if the result is present and second parameter is a runnable which will be executed when the result is null.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
//Employee id 5 is not available.
es.getEmployee(5)
    .ifPresentOrElse(System.out::println,
                     () -&gt; {System.out.println("No object present");});
//Output: No object present</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 4:</strong> Perform filter before consuming the result. Filter function takes predicate and returns Optional. We can test the result before processing. Filter function returns empty Optional if predicate returns false.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
es.getEmployee(3)
      .filter(emp -&gt; emp.getAge() &gt; 40)
      .ifPresent(System.out::println);
//Output: Employee{ id=3, name='Bill', age=42}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 5:</strong> If result is present then perform action on it else perform action by creating new Optional. If getEmployee did not return Employee then we can create and return empty Employee. Other alternatives to this function is orElse(T other), orElseGet(Supplier&lt;? extends T&gt; supplier) both of these functions returns T instead of Optional&lt;T&gt;</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
//Employee id 5 is not available.
es.getEmployee(5)
        .or(() -&gt; {return Optional.of(new Employee(0, "", 0));})
        .ifPresent(System.out::println);
//Output: Employee{ id=0, name='', age=0}</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 6:</strong> Throw exception if result is not present. orElseThrow takes supplier which should return throwable object.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
es.getEmployee(5).orElseThrow(() -&gt; {
            return new IllegalStateException("employee not available");
        });
//Output: Exception in thread "main" java.lang.IllegalStateException: employee not available</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 7:</strong> We can map the result to different type with map function. For example using map we can extract employee age from the employee object. The returned employee age from the map is wrapped in its own Optional. So make sure to unwrap it before using.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
es.getEmployee(2)
        .map(Employee::getAge)
        .ifPresent(System.out::println);
//Output: 28</code></pre> 
 </div> 
</div> 
<div class="paragraph"> 
 <p><strong>Recipe 8:</strong> Alternative to map is flatMap function. Both of these functions returns Optional except in flatMap we need to explicitly map to Optional.</p> 
</div> 
<div class="listingblock"> 
 <div class="content"> 
  <pre class="prettyprint highlight"><code class="language-java" data-lang="java">EmployeeService es = new EmployeeService();
es.getEmployee(2)
        .flatMap(emp -&gt; Optional.of(emp.getAge()))
        .ifPresent(System.out::println);
//Output: 28</code></pre> 
 </div> 
</div>
                </div>
            </div>
        </div>
    </article>

    <hr>

		<div id="push"></div>
    
    <!-- Footer -->
    <footer class="bg-graphite">
        <div class="container">
            <div class="row">
                <div class="col">
                    <ul class="list-inline text-center list-unstyled">
                        <li class="list-inline-item">
                            <a href="https://twitter.com/k_pradeep4j">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Baked with <a href="http://jbake.org">JBake v2.6.1</a></p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="../../../js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../../../js/bootstrap.min.js"></script>

    <!-- Custom Theme JavaScript 
    <script src="../../../js/clean-blog.min.js"></script>
    -->
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115619272-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-115619272-1');
    </script>
  </body>
</html>